---
import { Icon } from "astro-icon";

const account = {
	messages: Array(0).fill(0),
};
const cart = Array(0).fill(0);
const wishlist = Array(5).fill(0);

let pathname: string = Astro.url.pathname;
if (pathname.at(-1) === "/") {
	pathname = pathname.slice(0, pathname.length - 1);
}

const breadcrumbs = pathname.split("/").map((path: string) => {
	if (path === "cart") {
		return {
			href: "/cart",
			label: "Cart",
			iconName: "cart",
		};
	} else if (path === "wishlist") {
		return {
			href: "/wishlist",
			label: "Wishlist",
			iconName: "heart",
		};
	} else if (path === "shop") {
		return {
			href: "/shop",
			label: "Shop",
			iconName: "shop",
		};
	} else if (path === "product") {
		return {
			href: "/product",
			label: "Product",
			iconName: "cart",
		};
	} else {
		return {
			href: "/",
			label: "Home",
			iconName: "home",
		};
	}
});
---

<!DOCTYPE html>
<html lang="en" data-theme="light">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="theme-color" content="#2a303c" />
		<title>Document</title>
	</head>
	<body>
		<div class="drawer drawer-end">
			<input id="my-drawer" type="checkbox" class="drawer-toggle" />
			<div class="drawer-content overflow-hidden flex flex-col min-h-screen">
				<div class="container">
					<nav class="flex justify-end items-center gap-4 pt-2">
						<div class="flex items-center gap-2">
							<label class="swap btn btn-sm btn-ghost">
								<input id="theme" type="checkbox" />
								<Icon class="swap-on fill-secondary h-6" pack="mdi" name="white-balance-sunny" />
								<Icon class="swap-off fill-secondary h-6" pack="mdi" name="moon-waning-crescent" />
							</label>
							<div class="dropdown dropdown-end">
								<label tabindex="0" class="btn btn-sm btn-ghost flex items-center">
									<Icon class="h-6" pack="mdi" name="translate" />
									<Icon class="h-6" pack="mdi" name="expand-more" />
								</label>
								<ul tabindex="0" class="dropdown-content menu p-2 shadow bg-base-200 rounded-box mt-1">
									<li><a class="py-1 btn btn-sm btn-ghost">english</a></li>
									<li><a class="py-1 btn btn-sm btn-ghost">ukrainian</a></li>
								</ul>
							</div>
						</div>
					</nav>
					<div class="divider my-0"></div>
					<div class="flex-1 flex justify-between items-center gap-2 py-2">
						<div class="sm:block hidden">
							<a class="btn bt gap-2" href="/">buy shit</a>
						</div>
						<input type="text" placeholder="Search..." class="input w-full input-bordered" />
						<!-- <div class="flex flex-1 items-center">
							<div class="flex items-center flex-1">
								<label>
									<span class="btn btn-primary dropdown">
										All
										<Icon class="w-6" pack="mdi" name="expand-more" />
										<div class="dropdown-content">asdf</div>
									</span>
								</label>
							</div>
							<input type="text" placeholder="Search..." class="input w-full input-bordered" />
						</div> -->
						<div class="sm:flex hidden items-center gap-2">
							<div class="flex items-center">
								<label for="modal-account" class="indicator btn btn-ghost btn-circle">
									{Boolean(account.messages.length) && <span class="indicator-item badge">{account.messages.length}</span>}
									<Icon class="h-full p-1.5 btn btn-ghost btn-circle" pack="mdi" name="account" />
								</label>
							</div>
							<div class="dropdown dropdown-end relative flex items-center">
								<label tabindex="0" class="indicator">
									{Boolean(wishlist.length) && <span class="indicator-item badge">{wishlist.length}</span>}
									<Icon class="h-full p-1.5 btn btn-ghost btn-circle" pack="mdi" name="heart" />
									<div
										tabindex={0}
										class="flex flex-col dropdown-content p-4 bg-base-100 shadow-2xl rounded-box min-w-[425px] min-h-[150px] overflow-auto max-h-[800px] mt-12"
									>
										<div class="flex items-center sticky w-full -top-4 -mt-4 py-4 bg-[inherit] justify-between z-10">
											<h4 class="text-3xl font-bold">My Wishlist <span class="text-xs font-normal opacity-80">({wishlist.length})</span></h4>
											<a href="/wishlist" class="text-primary">View All</a>
										</div>
										<div class="flex flex-1 flex-col gap-4">
											{
												wishlist.length === 0 && (
													<div class="flex justify-center items-center flex-1">
														<h1 class="font-bold text-3xl">Go to shop</h1>
													</div>
												)
											}
											{
												wishlist.map((_) => {
													return (
														<div class="flex items-center gap-4">
															<img width="115" height="115" class="object-cover rounded-lg" src="https://fakeimg.pl/115x115/" />
															<div>
																<h4 class="text-sm font-bold opacity-80">BASEBALL PACK</h4>
																<h3 class="text-xl font-bold">STANDOUT BACKPACK</h3>
																<div class="flex flex-wrap gap-x-4 text-sm my-2">
																	{[
																		{ name: "size", value: "large" },
																		{ name: "color", value: "white" },
																		{ name: "color", value: "white" },
																	].map(({ name, value }) => {
																		return (
																			<div>
																				<p class="space-x-1">
																					<>
																						<span class="opacity-80">{name}:</span>
																						<span>{value}</span>
																					</>
																				</p>
																			</div>
																		);
																	})}
																</div>
																<div class="flex items-center justify-between">
																	<div class="flex gap-2">
																		<button class="btn btn-square btn-xs">-</button>
																		<input class="input text-center input-xs bg-base-200 w-16" type="text" value="1" />
																		<button class="btn btn-square btn-xs">+</button>
																	</div>
																	<div>
																		<p class="font-bold text-3xl">$12.59</p>
																	</div>
																</div>
															</div>
														</div>
													);
												})
											}
										</div>
									</div>
								</label>
							</div>
							<div class="dropdown dropdown-end relative flex items-center">
								<label tabindex="0" class="indicator">
									{Boolean(cart.length) && <span class="indicator-item badge">{cart.length}</span>}
									<Icon class="h-full p-1.5 btn btn-ghost btn-circle" pack="mdi" name="cart" />
									<div
										tabindex={0}
										class="flex flex-col dropdown-content p-4 bg-base-100 shadow-2xl rounded-box min-w-[425px] min-h-[150px] overflow-auto max-h-[800px] mt-12"
									>
										<div class="flex items-center sticky w-full -top-4 -mt-4 py-4 bg-[inherit] justify-between z-1">
											<h4 class="text-3xl font-bold">My Cart <span class="text-xs font-normal opacity-80">({cart.length})</span></h4>
											<a href="cart" class="text-primary">View All</a>
										</div>
										<div class="flex flex-1 flex-col gap-4">
											{
												cart.length === 0 && (
													<div class="flex justify-center items-center flex-1">
														<h1 class="font-bold text-3xl">Go to shop</h1>
													</div>
												)
											}
											{
												cart.map((_) => {
													return (
														<div class="flex items-center gap-4">
															<div class="">
																<img width="115" height="115" class="object-cover rounded-lg" src="https://fakeimg.pl/115x115/" />
															</div>
															<div>
																<h4 class="text-sm font-bold opacity-80">BASEBALL PACK</h4>
																<h3 class="text-xl font-bold">STANDOUT BACKPACK</h3>
																<div class="flex flex-wrap gap-x-4 text-sm my-2">
																	{[
																		{ name: "size", value: "large" },
																		{ name: "color", value: "white" },
																		{ name: "color", value: "white" },
																	].map(({ name, value }) => {
																		return (
																			<div>
																				<p class="space-x-1">
																					<>
																						<span class="opacity-80">{name}:</span>
																						<span>{value}</span>
																					</>
																				</p>
																			</div>
																		);
																	})}
																</div>
																<div class="flex items-center justify-between">
																	<div class="flex gap-2">
																		<button class="btn btn-square btn-xs">-</button>
																		<input class="input text-center input-xs bg-base-200 w-16" type="text" value="1" />
																		<button class="btn btn-square btn-xs">+</button>
																	</div>
																	<div>
																		<p class="font-bold text-3xl">$12.59</p>
																	</div>
																</div>
															</div>
														</div>
													);
												})
											}
										</div>
									</div>
								</label>
							</div>
						</div>
						<div class="block sm:hidden">
							<label for="my-drawer" class="btn btn-circle">
								<Icon class="h-full p-1.5" pack="mdi" name="menu" />
							</label>
						</div>
					</div>
					<div class="breadcrumbs">
						<ul class="text-sm breadcrumbs-items">
							{
								breadcrumbs.map(({ href, label, iconName }: any) => {
									return (
										<li>
											<a href={href}>
												<Icon class="h-4 mr-1" pack="mdi" name={iconName} />
												{label}
											</a>
										</li>
									);
								})
							}
						</ul>
					</div>
				</div>
				<main class="flex-1 pb-8">
					<slot />
				</main>
				<footer class="bg-base-300 py-4">
					<div class="container flex flex-col">
						<div class="footer">
							<div>
								<span class="footer-title">Services</span>
								<a class="link link-hover">Branding</a>
								<a class="link link-hover">Design</a>
								<a class="link link-hover">Marketing</a>
								<a class="link link-hover">Advertisement</a>
							</div>
							<div>
								<span class="footer-title">Company</span>
								<a class="link link-hover">About us</a>
								<a class="link link-hover">Contact</a>
								<a class="link link-hover">Jobs</a>
								<a class="link link-hover">Press kit</a>
							</div>
							<div>
								<span class="footer-title">Legal</span>
								<a class="link link-hover">Terms of use</a>
								<a class="link link-hover">Privacy policy</a>
								<a class="link link-hover">Cookie policy</a>
							</div>
							<div>
								<span class="footer-title">Newsletter</span>
								<div class="form-control">
									<label class="input-group">
										<input placeholder="Email" type="text" class="input input-bordered" />
										<span class="btn btn-primary">subscribe</span>
									</label>
								</div>
							</div>
						</div>
						<div class="divider my-2"></div>
						<div class="footer">
							<div class="items-center grid-flow-col">
								<p>ACME Industries Ltd. <br />Providing reliable tech since 1992</p>
							</div>
							<div class="md:place-self-center md:justify-self-end">
								<div class="flex gap-4">
									<Icon class="h-6" pack="mdi" name="facebook" />
									<Icon class="h-6" pack="mdi" name="instagram" />
									<Icon class="h-6" pack="mdi" name="medium" />
									<Icon class="h-6" pack="mdi" name="telegram" />
								</div>
							</div>
						</div>
					</div>
				</footer>
			</div>
			<div class="drawer-side">
				<label for="my-drawer" class="drawer-overlay"></label>
				<ul class="menu p-4 w-64 bg-base-100 text-base-content">
					<li>
						<a class="font-bold" href="/account">
							<Icon class="h-8" pack="mdi" name="account" />
							Account
						</a>
					</li>
					<li>
						<a class="font-bold" href="/wishlist">
							<Icon class="h-8" pack="mdi" name="heart" />
							Wishlist
						</a>
					</li>
					<li>
						<a class="font-bold" href="/cart">
							<Icon class="h-8" pack="mdi" name="cart" />
							Cart
						</a>
					</li>
				</ul>
			</div>
			<div class="btm-nav sm:hidden">
				<a class="active" href="/">
					<Icon class="h-8" pack="mdi" name="home" />
				</a>
				<a href="/cart">
					<Icon class="h-8" pack="mdi" name="cart" />
				</a>
				<a href="#">
					<label for="modal-account">
						<Icon class="h-8" pack="mdi" name="account" />
					</label>
				</a>
			</div>
		</div>
	</body>
	<input type="checkbox" id="modal-account" class="modal-toggle" />
	<label for="modal-account" class="modal sm:modal-middle cursor-pointer">
		<label class="modal-box m-4 mb-0 sm:m-0 relative" for="">
			<label class="absolute top-2 right-2 btn btn-sm btn-circle" for="modal-account">✕</label>
			<h4 class="font-bold text-3xl">Login</h4>
			<form>
				<div class="form-control gap-4 mt-6">
					<div class="flex flex-col">
						<label class="opacity-70 text-sm font-bold" for="email">EMAIL</label>
						<label class="input-group mt-2">
							<span class="opacity-80 text-sm font-bold">
								<Icon class="h-8" pack="mdi" name="email" />
							</span>
							<input class="input input-bordered w-full" type="text" />
						</label>
					</div>
					<div class="flex flex-col">
						<label class="opacity-70 text-sm font-bold" for="password">PASSWORD</label>
						<label class="input-group mt-2">
							<span class="opacity-80 text-sm font-bold">
								<Icon class="h-8" pack="mdi" name="lock" />
							</span>
							<input class="input input-bordered w-full" type="password" />
						</label>
						<label class="label py-0 mt-2">
							<a class="label-text-alt underline" href="#">Don't have an account?</a>
							<a class="label-text-alt underline text-right" href="#">Forgot password?</a>
						</label>
					</div>
				</div>
				<input class="btn btn-primary w-full mt-4" type="submit" value="LOGIN" />
				<div class="divider">or</div>
				<button class="btn btn-outline w-full gap-2">
					<Icon class="h-6" pack="mdi" name="google" />
					Continue with Google
				</button>
			</form>
		</label>
	</label>
	<script>
		const html = document.querySelector("html");
		const theme_checkbox = document.querySelector("#theme");
		const theme = window.localStorage.getItem("theme");
		const prefersLight = window.matchMedia("(prefers-color-scheme: light)");
		const isLight = theme !== null && theme === "light";

		theme_checkbox.checked = isLight;
		html.setAttribute("data-theme", isLight ? "light" : "dark");

		window.matchMedia("(prefers-color-scheme: light)").addEventListener("change", (event) => {
			const theme = window.localStorage.getItem("theme");
			const isLight = !!event.matches;
			theme_checkbox.checked = isLight;
			if (typeof theme === "string") {
				window.localStorage.setItem("theme", isLight ? "light" : "dark");
			} else {
				html.setAttribute("data-theme", isLight ? "light" : "dark");
			}
		});

		theme_checkbox.addEventListener("change", (e) => {
			const currentTheme = e.target.checked ? "light" : "dark";
			localStorage.setItem("theme", currentTheme);
			html.setAttribute("data-theme", currentTheme);
		});
	</script>
</html>
